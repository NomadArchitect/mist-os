# Copyright 2024 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

load("@io_bazel_rules_go//go:def.bzl", "go_binary", "go_library", "go_test")

go_library(
    name = "gnerator_lib",
    srcs = [
        "gnerator.go",
    ],
    importpath = "go.fuchsia.dev/fuchsia/build/tools/gnerator",
    target_compatible_with = [
        "@platforms//os:linux",
        "@platforms//cpu:x86_64",
    ],
    deps = [
        "//third_party/golibs:go.starlark.net/syntax",
    ],
)

go_binary(
    name = "gnerator",
    srcs = [
        "cmd/main.go",
    ],
    target_compatible_with = [
        "@platforms//os:linux",
        "@platforms//cpu:x86_64",
    ],
    deps = [
        ":gnerator_lib",
        "//third_party/golibs:go.starlark.net/starlark",
        "//third_party/golibs:go.starlark.net/syntax",
    ],
)

go_test(
    name = "gnerator_tests",
    srcs = [
        "gnerator_test.go",
    ],
    embed = [
        ":gnerator_lib",
    ],
    target_compatible_with = [
        "@platforms//os:linux",
        "@platforms//cpu:x86_64",
    ],
    deps = [
        "//third_party/golibs:github.com/google/go-cmp/cmp",
        "//third_party/golibs:go.starlark.net/starlark",
        "//third_party/golibs:go.starlark.net/syntax",
    ],
)

# Copyright 2024 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/components/fuchsia_unittest_package.gni")
import("//build/rust/rustc_library.gni")

rustc_library("netlink_packet_route") {
  edition = "2018"
  with_unit_tests = true

  deps = [
    "//src/starnix/lib/third_party/rust_netlink/netlink_packet_core",
    "//src/starnix/lib/third_party/rust_netlink/netlink_packet_utils",
    "//third_party/rust_crates:anyhow",
    "//third_party/rust_crates:bitflags",
    "//third_party/rust_crates:byteorder",
    "//third_party/rust_crates:libc",
    "//third_party/rust_crates:log",
    "//third_party/rust_crates:thiserror",
  ]

  sources = [
    "src/address/addr_flags.rs",
    "src/address/addr_scope.rs",
    "src/address/attribute.rs",
    "src/address/cache_info.rs",
    "src/address/error.rs",
    "src/address/message.rs",
    "src/address/mod.rs",
    "src/address/tests/ipv4.rs",
    "src/address/tests/ipv6.rs",
    "src/address/tests/mod.rs",
    "src/address_family_fallback.rs",
    "src/address_family_freebsd.rs",
    "src/address_family_linux.rs",
    "src/ip.rs",
    "src/lib.rs",
    "src/link/af_spec/bridge.rs",
    "src/link/af_spec/inet.rs",
    "src/link/af_spec/inet6.rs",
    "src/link/af_spec/inet6_cache.rs",
    "src/link/af_spec/inet6_devconf.rs",
    "src/link/af_spec/inet6_icmp.rs",
    "src/link/af_spec/inet6_iface_flag.rs",
    "src/link/af_spec/inet6_stats.rs",
    "src/link/af_spec/mod.rs",
    "src/link/af_spec/unspec.rs",
    "src/link/attribute.rs",
    "src/link/buffer_tool.rs",
    "src/link/down_reason.rs",
    "src/link/event.rs",
    "src/link/ext_mask.rs",
    "src/link/header.rs",
    "src/link/link_flag.rs",
    "src/link/link_info/bond.rs",
    "src/link/link_info/bond_port.rs",
    "src/link/link_info/bridge.rs",
    "src/link/link_info/bridge_port.rs",
    "src/link/link_info/gre.rs",
    "src/link/link_info/gre6.rs",
    "src/link/link_info/gre_tap.rs",
    "src/link/link_info/gre_tap6.rs",
    "src/link/link_info/gtp.rs",
    "src/link/link_info/hsr.rs",
    "src/link/link_info/info_data.rs",
    "src/link/link_info/info_port.rs",
    "src/link/link_info/infos.rs",
    "src/link/link_info/ipoib.rs",
    "src/link/link_info/ipvlan.rs",
    "src/link/link_info/mac_vlan.rs",
    "src/link/link_info/macsec.rs",
    "src/link/link_info/mod.rs",
    "src/link/link_info/sit.rs",
    "src/link/link_info/tun.rs",
    "src/link/link_info/veth.rs",
    "src/link/link_info/vlan.rs",
    "src/link/link_info/vrf.rs",
    "src/link/link_info/vti.rs",
    "src/link/link_info/vxlan.rs",
    "src/link/link_info/xfrm.rs",
    "src/link/link_info/xstats.rs",
    "src/link/link_layer_type.rs",
    "src/link/link_state.rs",
    "src/link/map.rs",
    "src/link/message.rs",
    "src/link/mod.rs",
    "src/link/phys_id.rs",
    "src/link/prop_list.rs",
    "src/link/proto_info/bridge.rs",
    "src/link/proto_info/inet6.rs",
    "src/link/proto_info/mod.rs",
    "src/link/sriov/broadcast.rs",
    "src/link/sriov/guid.rs",
    "src/link/sriov/link_state.rs",
    "src/link/sriov/mac.rs",
    "src/link/sriov/mod.rs",
    "src/link/sriov/rate.rs",
    "src/link/sriov/rss_query.rs",
    "src/link/sriov/spoofchk.rs",
    "src/link/sriov/stats.rs",
    "src/link/sriov/trust.rs",
    "src/link/sriov/tx_rate.rs",
    "src/link/sriov/vf_list.rs",
    "src/link/sriov/vf_port.rs",
    "src/link/sriov/vf_vlan.rs",
    "src/link/sriov/vlan.rs",
    "src/link/stats.rs",
    "src/link/stats64.rs",
    "src/link/tests/bond.rs",
    "src/link/tests/bridge.rs",
    "src/link/tests/hsr.rs",
    "src/link/tests/ipvlan.rs",
    "src/link/tests/ipvtap.rs",
    "src/link/tests/loopback.rs",
    "src/link/tests/macsec.rs",
    "src/link/tests/macvlan.rs",
    "src/link/tests/macvtap.rs",
    "src/link/tests/message.rs",
    "src/link/tests/mod.rs",
    "src/link/tests/prop_list.rs",
    "src/link/tests/sriov.rs",
    "src/link/tests/statistics.rs",
    "src/link/tests/veth.rs",
    "src/link/tests/vlan.rs",
    "src/link/tests/vrf.rs",
    "src/link/tests/vxlan.rs",
    "src/link/tests/xdp.rs",
    "src/link/tests/xfrm.rs",
    "src/link/vlan_protocol.rs",
    "src/link/wireless.rs",
    "src/link/xdp.rs",
    "src/message.rs",
    "src/neighbour/address.rs",
    "src/neighbour/attribute.rs",
    "src/neighbour/cache_info.rs",
    "src/neighbour/error.rs",
    "src/neighbour/flags.rs",
    "src/neighbour/header.rs",
    "src/neighbour/kind.rs",
    "src/neighbour/message.rs",
    "src/neighbour/mod.rs",
    "src/neighbour/state.rs",
    "src/neighbour/tests/bridge.rs",
    "src/neighbour/tests/ip.rs",
    "src/neighbour/tests/mod.rs",
    "src/neighbour_discovery_user_option/buffer.rs",
    "src/neighbour_discovery_user_option/constants.rs",
    "src/neighbour_discovery_user_option/header.rs",
    "src/neighbour_discovery_user_option/message.rs",
    "src/neighbour_discovery_user_option/mod.rs",
    "src/neighbour_discovery_user_option/nla.rs",
    "src/neighbour_discovery_user_option/tests.rs",
    "src/neighbour_table/attribute.rs",
    "src/neighbour_table/config.rs",
    "src/neighbour_table/error.rs",
    "src/neighbour_table/header.rs",
    "src/neighbour_table/message.rs",
    "src/neighbour_table/mod.rs",
    "src/neighbour_table/param.rs",
    "src/neighbour_table/stats.rs",
    "src/neighbour_table/tests.rs",
    "src/nsid/attribute.rs",
    "src/nsid/error.rs",
    "src/nsid/header.rs",
    "src/nsid/message.rs",
    "src/nsid/mod.rs",
    "src/nsid/tests.rs",
    "src/prefix/attribute.rs",
    "src/prefix/cache_info.rs",
    "src/prefix/error.rs",
    "src/prefix/header.rs",
    "src/prefix/message.rs",
    "src/prefix/mod.rs",
    "src/prefix/tests.rs",
    "src/route/address.rs",
    "src/route/attribute.rs",
    "src/route/cache_info.rs",
    "src/route/error.rs",
    "src/route/flags.rs",
    "src/route/header.rs",
    "src/route/lwtunnel.rs",
    "src/route/message.rs",
    "src/route/metrics.rs",
    "src/route/mfc_stats.rs",
    "src/route/mod.rs",
    "src/route/mpls.rs",
    "src/route/next_hops.rs",
    "src/route/preference.rs",
    "src/route/realm.rs",
    "src/route/tests/cache_info.rs",
    "src/route/tests/expires.rs",
    "src/route/tests/loopback.rs",
    "src/route/tests/mod.rs",
    "src/route/tests/mpls.rs",
    "src/route/tests/multipath.rs",
    "src/route/tests/realm.rs",
    "src/route/tests/route_flags.rs",
    "src/route/tests/uid.rs",
    "src/route/tests/via.rs",
    "src/route/via.rs",
    "src/rule/action.rs",
    "src/rule/attribute.rs",
    "src/rule/error.rs",
    "src/rule/flags.rs",
    "src/rule/header.rs",
    "src/rule/message.rs",
    "src/rule/mod.rs",
    "src/rule/port_range.rs",
    "src/rule/tests/fw_mark.rs",
    "src/rule/tests/iif_oif.rs",
    "src/rule/tests/l3mdev.rs",
    "src/rule/tests/mod.rs",
    "src/rule/tests/on_boot_rules.rs",
    "src/rule/tests/sport_dport.rs",
    "src/rule/tests/src_dst.rs",
    "src/rule/uid_range.rs",
    "src/tc/actions/action.rs",
    "src/tc/actions/header.rs",
    "src/tc/actions/message.rs",
    "src/tc/actions/mirror.rs",
    "src/tc/actions/mod.rs",
    "src/tc/actions/nat.rs",
    "src/tc/actions/nat_flag.rs",
    "src/tc/actions/tests/action.rs",
    "src/tc/actions/tests/header.rs",
    "src/tc/actions/tests/message.rs",
    "src/tc/actions/tests/mirror.rs",
    "src/tc/actions/tests/mod.rs",
    "src/tc/actions/tests/nat.rs",
    "src/tc/attribute.rs",
    "src/tc/error.rs",
    "src/tc/filters/cls_u32.rs",
    "src/tc/filters/matchall.rs",
    "src/tc/filters/mod.rs",
    "src/tc/filters/u32_flags.rs",
    "src/tc/header.rs",
    "src/tc/message.rs",
    "src/tc/mod.rs",
    "src/tc/options.rs",
    "src/tc/qdiscs/fq_codel.rs",
    "src/tc/qdiscs/ingress.rs",
    "src/tc/qdiscs/mod.rs",
    "src/tc/stats/basic.rs",
    "src/tc/stats/compat.rs",
    "src/tc/stats/mod.rs",
    "src/tc/stats/queue.rs",
    "src/tc/stats/stats2.rs",
    "src/tc/stats/xstats.rs",
    "src/tc/tests/filter_matchall.rs",
    "src/tc/tests/filter_u32.rs",
    "src/tc/tests/mod.rs",
    "src/tc/tests/qdisc_fq_codel.rs",
    "src/tc/tests/qdisc_ingress.rs",
    "src/tests.rs",
  ]
}

fuchsia_unittest_package("netlink_packet_route_test_package") {
  deps = [ ":netlink_packet_route_test" ]
}

group("tests") {
  testonly = true
  deps = [ ":netlink_packet_route_test_package" ]
}

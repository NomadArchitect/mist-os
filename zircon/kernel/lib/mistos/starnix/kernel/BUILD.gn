# Copyright 2024 Mist Tecnologia LTDA. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/zircon/migrated_targets.gni")

zx_library("kernel") {
  sources = [
    "arch/x64/loader.cc",
    "arch/x64/syscalls.cc",
    "debugcommands.cc",
    "execution/executor.cc",
    "fs/mistos/syslog.cc",
    "fs/tmpfs.cc",
    "loader.cc",
    "logging/logging.cc",
    "mm/memory_accessor.cc",
    "mm/memory_manager.cc",
    "mm/syscalls.cc",
    "runner/container.cc",
    "starnix-loader.cc",
    "syscalls/misc.cc",
    "task/current_task.cc",
    "task/kernel.cc",
    "task/pidtable.cc",
    "task/process_group.cc",
    "task/session.cc",
    "task/syscalls.cc",
    "task/task.cc",
    "task/thread_group.cc",
    "vfs/anon_node.cc",
    "vfs/buffers/io_buffers.cc",
    "vfs/dir_entry.cc",
    "vfs/fd_numbers.cc",
    "vfs/fd_table.cc",
    "vfs/file_object.cc",
    "vfs/file_system.cc",
    "vfs/fs_args.cc",
    "vfs/fs_context.cc",
    "vfs/fs_node.cc",
    "vfs/module.cc",
    "vfs/namespace.cc",
    "vfs/vmo_file.cc",
    "vfs/xattr.cc",
    "zircon/task_dispatcher.cc",
  ]

  public_deps = [
    "//zircon/kernel/lib/mistos/linux_uapi",
    "//zircon/kernel/lib/mistos/starnix_uapi",
    "//zircon/kernel/lib/mistos/zx",
    "//zircon/system/ulib/zxtest:prod",
  ]

  deps = [
    "//zircon/kernel/lib/console",
    "//zircon/kernel/lib/mistos/elfldltl",
    "//zircon/kernel/lib/mistos/userloader",
    "//zircon/kernel/lib/mistos/zx_syscalls",
  ]
}

group("tests") {
  deps = [ "tests" ]
}
